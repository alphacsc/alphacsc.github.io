
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Extracting artifact and evoked response atoms from the sample dataset &#8212; alphacsc 0.4.1 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css?v=d2d258e8" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
  
  <!-- So that users can add custom icons -->
  <script src="../../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../../_static/documentation_options.js?v=c87aa342"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'auto_examples/multicsc/plot_sample_evoked_response';</script>
    <script>
        DOCUMENTATION_OPTIONS.theme_version = '0.16.1';
        DOCUMENTATION_OPTIONS.theme_switcher_json_url = 'https://alphacsc.github.io/stable/_static/switcher.json';
        DOCUMENTATION_OPTIONS.theme_switcher_version_match = '0.4.1';
        DOCUMENTATION_OPTIONS.show_version_warning_banner =
            false;
        </script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Univariate CSC with an alpha-stable distribution" href="../noise_alpha/index.html" />
    <link rel="prev" title="Extracting artifact and evoked response atoms from the MNE sample dataset" href="sample_evoked_response_dicodile.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="0.4.1" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
  
    <p class="title logo__title">alphacsc 0.4.1 documentation</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../models.html">
    Model descriptions
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../index.html">
    Examples Gallery
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../api.html">
    API Documentation
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">
<div class="version-switcher__container dropdown pst-js-only">
  <button id="pst-version-switcher-button-2"
    type="button"
    class="version-switcher__button btn btn-sm dropdown-toggle"
    data-bs-toggle="dropdown"
    aria-haspopup="listbox"
    aria-controls="pst-version-switcher-list-2"
    aria-label="Version switcher list"
  >
    Choose version  <!-- this text may get changed later by javascript -->
    <span class="caret"></span>
  </button>
  <div id="pst-version-switcher-list-2"
    class="version-switcher__menu dropdown-menu list-group-flush py-0"
    role="listbox" aria-labelledby="pst-version-switcher-button-2">
    <!-- dropdown will be populated by javascript on page load -->
  </div>
</div></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/alphacsc/alphacsc" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://pypi.org/project/alphacsc/" title="PyPI" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fas fa-box fa-lg" aria-hidden="true"></i>
            <span class="sr-only">PyPI</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../models.html">
    Model descriptions
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../index.html">
    Examples Gallery
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../api.html">
    API Documentation
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">
<div class="version-switcher__container dropdown pst-js-only">
  <button id="pst-version-switcher-button-3"
    type="button"
    class="version-switcher__button btn btn-sm dropdown-toggle"
    data-bs-toggle="dropdown"
    aria-haspopup="listbox"
    aria-controls="pst-version-switcher-list-3"
    aria-label="Version switcher list"
  >
    Choose version  <!-- this text may get changed later by javascript -->
    <span class="caret"></span>
  </button>
  <div id="pst-version-switcher-list-3"
    class="version-switcher__menu dropdown-menu list-group-flush py-0"
    role="listbox" aria-labelledby="pst-version-switcher-button-3">
    <!-- dropdown will be populated by javascript on page load -->
  </div>
</div></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/alphacsc/alphacsc" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://pypi.org/project/alphacsc/" title="PyPI" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fas fa-box fa-lg" aria-hidden="true"></i>
            <span class="sr-only">PyPI</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../csc/index.html">Univariate CSC</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../csc/plot_simulate_randomstate.html">Selecting random state for CSC</a></li>
<li class="toctree-l2"><a class="reference internal" href="../csc/plot_lfp_data.html">CSC to learn LFP spiking atoms</a></li>
<li class="toctree-l2"><a class="reference internal" href="../csc/plot_cross_frequency_coupling.html">Extracting cross-frequency coupling waveforms from rodent LFP data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../csc/plot_simulate_csc.html">Vanilla CSC on simulated data</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../dicodile/index.html">Univariate and Multivariate CSC with ‘dicodile’ solver</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../dicodile/plot_gait.html">Gait (steps) example</a></li>
</ul>
</details></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="index.html">Multivariate CSC with rank 1 constraints</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="plot_somato_mu_waves.html">Extracting <span class="math notranslate nohighlight">\(\mu\)</span>-wave from the somato-sensory dataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="sample_evoked_response_dicodile.html">Extracting artifact and evoked response atoms from the MNE sample dataset</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Extracting artifact and evoked response atoms from the sample dataset</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../noise_alpha/index.html">Univariate CSC with an alpha-stable distribution</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../noise_alpha/plot_simulate_alphacsc.html">Alpha CSC on simulated data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../noise_alpha/plot_empirical_strong_artifacts.html">Alpha CSC on empirical time-series with strong artifacts</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../other/index.html">Other shift-invariant dictionary learning algorithms</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../other/plot_simulate_motif.html">MoTIF on simulated data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../other/plot_simulate_swm.html">SWM on simulated data</a></li>
</ul>
</details></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../index.html" class="nav-link">Examples Gallery</a></li>
    
    
    <li class="breadcrumb-item"><a href="index.html" class="nav-link">Multivariate CSC with rank 1 constraints</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">Extracting artifact and evoked response atoms from the sample dataset</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-auto-examples-multicsc-plot-sample-evoked-response-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code.</p>
</div>
<section class="sphx-glr-example-title" id="extracting-artifact-and-evoked-response-atoms-from-the-sample-dataset">
<span id="sphx-glr-auto-examples-multicsc-plot-sample-evoked-response-py"></span><h1>Extracting artifact and evoked response atoms from the sample dataset<a class="headerlink" href="#extracting-artifact-and-evoked-response-atoms-from-the-sample-dataset" title="Link to this heading">#</a></h1>
<p>This example illustrates how to learn rank-1 <a class="footnote-reference brackets" href="#id2" id="id1" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a> atoms on the multivariate
sample dataset from <code class="code docutils literal notranslate"><span class="pre">mne</span></code>. We display a selection of atoms, featuring
heartbeat and eyeblink artifacts, two atoms of evoked responses, and a
non-sinusoidal oscillation.</p>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id2" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id1">1</a><span class="fn-bracket">]</span></span>
<p>Dupré La Tour, T., Moreau, T., Jas, M., &amp; Gramfort, A. (2018).
<a class="reference external" href="https://arxiv.org/abs/1805.09654v2">Multivariate Convolutional Sparse Coding for Electromagnetic Brain Signals</a>. Advances in Neural Information
Processing Systems (NIPS).</p>
</aside>
</aside>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Authors: Thomas Moreau &lt;thomas.moreau@inria.fr&gt;</span>
<span class="c1">#          Mainak Jas &lt;mainak.jas@telecom-paristech.fr&gt;</span>
<span class="c1">#          Tom Dupre La Tour &lt;tom.duprelatour@telecom-paristech.fr&gt;</span>
<span class="c1">#          Alexandre Gramfort &lt;alexandre.gramfort@telecom-paristech.fr&gt;</span>
<span class="c1">#</span>
<span class="c1"># License: BSD (3-clause)</span>
</pre></div>
</div>
<p>Let us first define the parameters of our model.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Sampling frequency the signal will be resampled to</span>
<a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">sfreq</span></a> <span class="o">=</span> <span class="mf">150.</span>

<span class="c1"># Define the shape of the dictionary</span>
<a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">n_atoms</span></a> <span class="o">=</span> <span class="mi">40</span>
<a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">n_times_atom</span></a> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">sfreq</span></a> <span class="o">*</span> <span class="mf">1.0</span><span class="p">))</span>  <span class="c1"># 1000. ms</span>

<span class="c1"># Regularization parameter which control sparsity</span>
<a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">reg</span></a> <span class="o">=</span> <span class="mf">0.1</span>

<span class="c1"># Number of processors for parallel computing</span>
<a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">n_jobs</span></a> <span class="o">=</span> <span class="mi">5</span>

<span class="c1"># To accelerate the run time of this example, we split the signal in n_slits.</span>
<span class="c1"># The number of splits should actually be the smallest possible to avoid</span>
<span class="c1"># introducing border artifacts in the learned atoms and it should be not much</span>
<span class="c1"># larger than n_jobs.</span>
<a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">n_splits</span></a> <span class="o">=</span> <span class="mi">10</span>
</pre></div>
</div>
<p>Next, we define the parameters for multivariate CSC</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">alphacsc</span><span class="w"> </span><span class="kn">import</span> <a href="../../generated/alphacsc.GreedyCDL.html#alphacsc.GreedyCDL" title="alphacsc.GreedyCDL" class="sphx-glr-backref-module-alphacsc sphx-glr-backref-type-py-class"><span class="n">GreedyCDL</span></a>
<a href="../../generated/alphacsc.GreedyCDL.html#alphacsc.GreedyCDL" title="alphacsc.GreedyCDL" class="sphx-glr-backref-module-alphacsc sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">cdl</span></a> <span class="o">=</span> <a href="../../generated/alphacsc.GreedyCDL.html#alphacsc.GreedyCDL" title="alphacsc.GreedyCDL" class="sphx-glr-backref-module-alphacsc sphx-glr-backref-type-py-class"><span class="n">GreedyCDL</span></a><span class="p">(</span>
    <span class="c1"># Shape of the dictionary</span>
    <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">n_atoms</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">n_atoms</span></a><span class="p">,</span>
    <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">n_times_atom</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">n_times_atom</span></a><span class="p">,</span>
    <span class="c1"># Request a rank1 dictionary with unit norm temporal and spatial maps</span>
    <span class="n">rank1</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">uv_constraint</span><span class="o">=</span><span class="s1">&#39;separate&#39;</span><span class="p">,</span>
    <span class="c1"># apply a temporal window reparametrization</span>
    <span class="n">window</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="c1"># at the end, refit the activations with fixed support and no reg to unbias</span>
    <span class="n">unbiased_z_hat</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="c1"># Initialize the dictionary with random chunk from the data</span>
    <span class="n">D_init</span><span class="o">=</span><span class="s1">&#39;chunk&#39;</span><span class="p">,</span>
    <span class="c1"># rescale the regularization parameter to be a percentage of lambda_max</span>
    <span class="n">lmbd_max</span><span class="o">=</span><span class="s2">&quot;scaled&quot;</span><span class="p">,</span>
    <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">reg</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">reg</span></a><span class="p">,</span>
    <span class="c1"># Number of iteration for the alternate minimization and cvg threshold</span>
    <span class="n">n_iter</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
    <span class="n">eps</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">,</span>
    <span class="c1"># solver for the z-step</span>
    <span class="n">solver_z</span><span class="o">=</span><span class="s2">&quot;lgcd&quot;</span><span class="p">,</span>
    <span class="n">solver_z_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;tol&#39;</span><span class="p">:</span> <span class="mf">1e-2</span><span class="p">,</span>
                     <span class="s1">&#39;max_iter&#39;</span><span class="p">:</span> <span class="mi">10000</span><span class="p">},</span>
    <span class="c1"># solver for the d-step</span>
    <span class="n">solver_d</span><span class="o">=</span><span class="s1">&#39;alternate_adaptive&#39;</span><span class="p">,</span>
    <span class="n">solver_d_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;max_iter&#39;</span><span class="p">:</span> <span class="mi">300</span><span class="p">},</span>
    <span class="c1"># sort atoms by explained variances</span>
    <span class="n">sort_atoms</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="c1"># Technical parameters</span>
    <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">n_jobs</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">n_jobs</span></a><span class="p">)</span>
</pre></div>
</div>
<p>Load the sample data from MNE-python and select the gradiometer channels.
The MNE sample data contains MEG recordings of a subject with visual and
auditory stimuli. We load the data using utilities from MNE-python as a Raw
object and select the gradiometers from the signal.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">mne</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Loading the data...&quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">flush</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a href="https://docs.python.org/3/library/pathlib.html#pathlib.PosixPath" title="pathlib.PosixPath" class="sphx-glr-backref-module-pathlib sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data_path</span></a> <span class="o">=</span> <a href="https://mne.tools/stable/generated/mne.datasets.sample.data_path.html#mne.datasets.sample.data_path" title="mne.datasets.sample.data_path" class="sphx-glr-backref-module-mne-datasets-sample sphx-glr-backref-type-py-function"><span class="n">mne</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">sample</span><span class="o">.</span><span class="n">data_path</span></a><span class="p">()</span>
<a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subjects_dir</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/os.path.html#os.path.join" title="os.path.join" class="sphx-glr-backref-module-os-path sphx-glr-backref-type-py-function"><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/pathlib.html#pathlib.PosixPath" title="pathlib.PosixPath" class="sphx-glr-backref-module-pathlib sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data_path</span></a><span class="p">,</span> <span class="s2">&quot;subjects&quot;</span><span class="p">)</span>
<a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data_dir</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/os.path.html#os.path.join" title="os.path.join" class="sphx-glr-backref-module-os-path sphx-glr-backref-type-py-function"><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/pathlib.html#pathlib.PosixPath" title="pathlib.PosixPath" class="sphx-glr-backref-module-pathlib sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data_path</span></a><span class="p">,</span> <span class="s1">&#39;MEG&#39;</span><span class="p">,</span> <span class="s1">&#39;sample&#39;</span><span class="p">)</span>
<a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">file_name</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/os.path.html#os.path.join" title="os.path.join" class="sphx-glr-backref-module-os-path sphx-glr-backref-type-py-function"><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data_dir</span></a><span class="p">,</span> <span class="s1">&#39;sample_audvis_raw.fif&#39;</span><span class="p">)</span>
<a href="https://mne.tools/stable/generated/mne.io.Raw.html#mne.io.Raw" title="mne.io.Raw" class="sphx-glr-backref-module-mne-io sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">raw</span></a> <span class="o">=</span> <a href="https://mne.tools/stable/generated/mne.io.read_raw_fif.html#mne.io.read_raw_fif" title="mne.io.read_raw_fif" class="sphx-glr-backref-module-mne-io sphx-glr-backref-type-py-function"><span class="n">mne</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">read_raw_fif</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">file_name</span></a><span class="p">,</span> <span class="n">preload</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<a href="https://mne.tools/stable/generated/mne.io.Raw.html#mne.io.Raw.pick_types" title="mne.io.Raw.pick_types" class="sphx-glr-backref-module-mne-io sphx-glr-backref-type-py-method"><span class="n">raw</span><span class="o">.</span><span class="n">pick_types</span></a><span class="p">(</span><span class="n">meg</span><span class="o">=</span><span class="s1">&#39;grad&#39;</span><span class="p">,</span> <span class="n">eeg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">eog</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">stim</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;done&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Loading the data...Using default location ~/mne_data for sample...

  0%|                                              | 0.00/1.65G [00:00&lt;?, ?B/s]
  0%|                                     | 1.48M/1.65G [00:00&lt;02:04, 13.3MB/s]
  0%|                                     | 2.81M/1.65G [00:00&lt;02:34, 10.7MB/s]
  0%|▏                                    | 8.01M/1.65G [00:00&lt;01:01, 26.8MB/s]
  1%|▎                                    | 13.8M/1.65G [00:00&lt;00:43, 38.0MB/s]
  1%|▍                                    | 20.2M/1.65G [00:00&lt;00:34, 46.7MB/s]
  2%|▌                                    | 27.8M/1.65G [00:00&lt;00:28, 56.4MB/s]
  2%|▊                                    | 34.0M/1.65G [00:00&lt;00:27, 58.0MB/s]
  2%|▉                                    | 39.9M/1.65G [00:00&lt;00:28, 56.3MB/s]
  3%|█                                    | 46.7M/1.65G [00:00&lt;00:26, 59.8MB/s]
  3%|█▏                                   | 53.7M/1.65G [00:01&lt;00:25, 62.8MB/s]
  4%|█▎                                   | 60.8M/1.65G [00:01&lt;00:24, 65.3MB/s]
  4%|█▌                                   | 68.0M/1.65G [00:01&lt;00:23, 67.3MB/s]
  5%|█▋                                   | 75.1M/1.65G [00:01&lt;00:23, 68.5MB/s]
  5%|█▊                                   | 82.3M/1.65G [00:01&lt;00:22, 69.5MB/s]
  5%|██                                   | 89.8M/1.65G [00:01&lt;00:21, 71.1MB/s]
  6%|██▏                                  | 96.9M/1.65G [00:01&lt;00:31, 49.9MB/s]
  6%|██▎                                   | 103M/1.65G [00:01&lt;00:30, 50.7MB/s]
  7%|██▌                                   | 110M/1.65G [00:02&lt;00:28, 54.8MB/s]
  7%|██▋                                   | 118M/1.65G [00:02&lt;00:25, 61.2MB/s]
  8%|██▊                                   | 124M/1.65G [00:02&lt;00:35, 43.1MB/s]
  8%|██▉                                   | 129M/1.65G [00:02&lt;00:34, 43.7MB/s]
  8%|███▏                                  | 138M/1.65G [00:02&lt;00:29, 52.2MB/s]
  9%|███▎                                  | 146M/1.65G [00:02&lt;00:25, 59.5MB/s]
  9%|███▌                                  | 153M/1.65G [00:02&lt;00:24, 62.4MB/s]
 10%|███▋                                  | 160M/1.65G [00:02&lt;00:23, 63.9MB/s]
 10%|███▊                                  | 167M/1.65G [00:03&lt;00:24, 61.8MB/s]
 10%|███▉                                  | 173M/1.65G [00:03&lt;00:56, 26.3MB/s]
 11%|████                                  | 178M/1.65G [00:03&lt;00:56, 26.1MB/s]
 11%|████▏                                 | 184M/1.65G [00:03&lt;00:46, 31.7MB/s]
 11%|████▎                                 | 189M/1.65G [00:04&lt;00:55, 26.6MB/s]
 12%|████▌                                 | 197M/1.65G [00:04&lt;00:40, 35.8MB/s]
 12%|████▋                                 | 206M/1.65G [00:04&lt;00:32, 44.9MB/s]
 13%|████▉                                 | 214M/1.65G [00:04&lt;00:26, 53.4MB/s]
 13%|█████                                 | 222M/1.65G [00:04&lt;00:23, 60.5MB/s]
 14%|█████▎                                | 230M/1.65G [00:04&lt;00:21, 64.8MB/s]
 14%|█████▍                                | 238M/1.65G [00:04&lt;00:23, 59.2MB/s]
 15%|█████▌                                | 244M/1.65G [00:05&lt;00:41, 33.7MB/s]
 15%|█████▋                                | 250M/1.65G [00:05&lt;00:38, 36.6MB/s]
 15%|█████▊                                | 255M/1.65G [00:05&lt;00:43, 31.9MB/s]
 16%|█████▉                                | 260M/1.65G [00:05&lt;00:38, 36.0MB/s]
 16%|██████                                | 266M/1.65G [00:05&lt;00:35, 39.6MB/s]
 16%|██████▏                               | 270M/1.65G [00:05&lt;00:33, 41.3MB/s]
 17%|██████▍                               | 278M/1.65G [00:05&lt;00:28, 48.7MB/s]
 17%|██████▌                               | 285M/1.65G [00:06&lt;00:25, 52.8MB/s]
 18%|██████▋                               | 291M/1.65G [00:06&lt;00:24, 54.9MB/s]
 18%|██████▊                               | 297M/1.65G [00:06&lt;00:37, 35.9MB/s]
 18%|██████▉                               | 301M/1.65G [00:06&lt;00:41, 32.8MB/s]
 19%|███████                               | 309M/1.65G [00:06&lt;00:32, 41.8MB/s]
 19%|███████▏                              | 315M/1.65G [00:06&lt;00:29, 45.9MB/s]
 19%|███████▍                              | 321M/1.65G [00:06&lt;00:26, 49.3MB/s]
 20%|███████▌                              | 327M/1.65G [00:07&lt;00:25, 51.4MB/s]
 20%|███████▋                              | 333M/1.65G [00:07&lt;00:24, 53.8MB/s]
 21%|███████▊                              | 339M/1.65G [00:07&lt;00:24, 53.0MB/s]
 21%|███████▉                              | 345M/1.65G [00:07&lt;00:36, 35.4MB/s]
 21%|████████                              | 349M/1.65G [00:07&lt;00:38, 34.3MB/s]
 21%|████████                              | 353M/1.65G [00:07&lt;00:38, 33.5MB/s]
 22%|████████▏                             | 357M/1.65G [00:07&lt;00:37, 34.5MB/s]
 22%|████████▎                             | 363M/1.65G [00:08&lt;00:31, 41.2MB/s]
 22%|████████▌                             | 371M/1.65G [00:08&lt;00:25, 49.5MB/s]
 23%|████████▋                             | 379M/1.65G [00:08&lt;00:21, 58.2MB/s]
 23%|████████▉                             | 387M/1.65G [00:08&lt;00:19, 64.8MB/s]
 24%|█████████                             | 394M/1.65G [00:08&lt;00:18, 66.6MB/s]
 24%|█████████▎                            | 402M/1.65G [00:08&lt;00:17, 71.4MB/s]
 25%|█████████▍                            | 411M/1.65G [00:08&lt;00:16, 75.4MB/s]
 25%|█████████▋                            | 419M/1.65G [00:08&lt;00:15, 77.6MB/s]
 26%|█████████▊                            | 428M/1.65G [00:08&lt;00:15, 79.9MB/s]
 26%|██████████                            | 436M/1.65G [00:09&lt;00:21, 56.1MB/s]
 27%|██████████▏                           | 443M/1.65G [00:09&lt;00:21, 57.6MB/s]
 27%|██████████▎                           | 449M/1.65G [00:09&lt;00:19, 60.5MB/s]
 28%|██████████▌                           | 457M/1.65G [00:09&lt;00:18, 64.8MB/s]
 28%|██████████▋                           | 464M/1.65G [00:09&lt;00:18, 63.7MB/s]
 29%|██████████▊                           | 472M/1.65G [00:09&lt;00:17, 66.9MB/s]
 29%|███████████                           | 479M/1.65G [00:09&lt;00:17, 67.9MB/s]
 29%|███████████▏                          | 486M/1.65G [00:09&lt;00:18, 63.6MB/s]
 30%|███████████▎                          | 493M/1.65G [00:09&lt;00:17, 65.5MB/s]
 30%|███████████▍                          | 500M/1.65G [00:10&lt;00:17, 66.9MB/s]
 31%|███████████▋                          | 508M/1.65G [00:10&lt;00:15, 71.6MB/s]
 31%|███████████▊                          | 515M/1.65G [00:10&lt;00:25, 44.0MB/s]
 32%|███████████▉                          | 521M/1.65G [00:10&lt;00:33, 34.3MB/s]
 32%|████████████                          | 526M/1.65G [00:11&lt;00:46, 24.1MB/s]
 32%|████████████▏                         | 530M/1.65G [00:11&lt;00:42, 26.7MB/s]
 32%|████████████▎                         | 537M/1.65G [00:11&lt;00:33, 33.7MB/s]
 33%|████████████▍                         | 543M/1.65G [00:11&lt;00:28, 38.9MB/s]
 33%|████████████▋                         | 551M/1.65G [00:11&lt;00:22, 48.5MB/s]
 34%|████████████▊                         | 560M/1.65G [00:11&lt;00:19, 57.3MB/s]
 34%|█████████████                         | 567M/1.65G [00:12&lt;00:45, 23.9MB/s]
 35%|█████████████▏                        | 572M/1.65G [00:12&lt;00:46, 23.3MB/s]
 35%|█████████████▏                        | 576M/1.65G [00:12&lt;00:51, 20.8MB/s]
 35%|█████████████▎                        | 580M/1.65G [00:12&lt;00:46, 23.2MB/s]
 36%|█████████████▌                        | 588M/1.65G [00:13&lt;00:32, 32.6MB/s]
 36%|█████████████▋                        | 595M/1.65G [00:13&lt;00:27, 39.0MB/s]
 36%|█████████████▊                        | 600M/1.65G [00:13&lt;00:35, 30.0MB/s]
 37%|█████████████▉                        | 606M/1.65G [00:13&lt;00:29, 35.1MB/s]
 37%|██████████████                        | 613M/1.65G [00:13&lt;00:25, 40.6MB/s]
 37%|██████████████▏                       | 619M/1.65G [00:13&lt;00:22, 46.5MB/s]
 38%|██████████████▎                       | 625M/1.65G [00:13&lt;00:22, 46.3MB/s]
 38%|██████████████▍                       | 630M/1.65G [00:14&lt;00:30, 33.5MB/s]
 38%|██████████████▌                       | 635M/1.65G [00:14&lt;00:27, 36.7MB/s]
 39%|██████████████▋                       | 641M/1.65G [00:14&lt;00:25, 40.4MB/s]
 39%|██████████████▊                       | 647M/1.65G [00:14&lt;00:22, 45.3MB/s]
 39%|██████████████▉                       | 652M/1.65G [00:14&lt;00:21, 46.4MB/s]
 40%|███████████████                       | 657M/1.65G [00:14&lt;00:31, 31.9MB/s]
 40%|███████████████▏                      | 661M/1.65G [00:14&lt;00:29, 34.1MB/s]
 40%|███████████████▎                      | 665M/1.65G [00:15&lt;00:28, 34.8MB/s]
 41%|███████████████▍                      | 672M/1.65G [00:15&lt;00:22, 42.7MB/s]
 41%|███████████████▌                      | 679M/1.65G [00:15&lt;00:20, 48.5MB/s]
 41%|███████████████▊                      | 686M/1.65G [00:15&lt;00:17, 54.2MB/s]
 42%|███████████████▉                      | 692M/1.65G [00:15&lt;00:18, 52.8MB/s]
 42%|████████████████                      | 698M/1.65G [00:15&lt;00:17, 55.8MB/s]
 43%|████████████████▏                     | 704M/1.65G [00:15&lt;00:16, 57.7MB/s]
 43%|████████████████▎                     | 711M/1.65G [00:15&lt;00:15, 60.0MB/s]
 43%|████████████████▌                     | 718M/1.65G [00:15&lt;00:14, 63.2MB/s]
 44%|████████████████▋                     | 725M/1.65G [00:15&lt;00:14, 65.9MB/s]
 44%|████████████████▊                     | 733M/1.65G [00:16&lt;00:13, 68.5MB/s]
 45%|█████████████████                     | 740M/1.65G [00:16&lt;00:13, 70.1MB/s]
 45%|█████████████████▏                    | 747M/1.65G [00:16&lt;00:35, 25.7MB/s]
 46%|█████████████████▎                    | 753M/1.65G [00:16&lt;00:29, 30.5MB/s]
 46%|█████████████████▍                    | 760M/1.65G [00:17&lt;00:24, 35.8MB/s]
 46%|█████████████████▋                    | 767M/1.65G [00:17&lt;00:20, 42.7MB/s]
 47%|█████████████████▊                    | 775M/1.65G [00:17&lt;00:17, 49.3MB/s]
 47%|█████████████████▉                    | 781M/1.65G [00:17&lt;00:19, 45.3MB/s]
 48%|██████████████████                    | 787M/1.65G [00:17&lt;00:20, 43.1MB/s]
 48%|██████████████████▏                   | 793M/1.65G [00:17&lt;00:18, 46.9MB/s]
 48%|██████████████████▍                   | 800M/1.65G [00:17&lt;00:16, 53.2MB/s]
 49%|██████████████████▌                   | 808M/1.65G [00:17&lt;00:14, 58.6MB/s]
 49%|██████████████████▋                   | 815M/1.65G [00:18&lt;00:13, 62.4MB/s]
 50%|██████████████████▉                   | 822M/1.65G [00:18&lt;00:12, 65.4MB/s]
 50%|███████████████████                   | 829M/1.65G [00:18&lt;00:31, 26.3MB/s]
 50%|███████████████████▏                  | 834M/1.65G [00:18&lt;00:29, 27.3MB/s]
 51%|███████████████████▎                  | 841M/1.65G [00:19&lt;00:24, 33.4MB/s]
 51%|███████████████████▍                  | 848M/1.65G [00:19&lt;00:20, 39.5MB/s]
 52%|███████████████████▋                  | 854M/1.65G [00:19&lt;00:18, 44.3MB/s]
 52%|███████████████████▊                  | 860M/1.65G [00:19&lt;00:23, 33.2MB/s]
 52%|███████████████████▉                  | 865M/1.65G [00:19&lt;00:22, 35.7MB/s]
 53%|████████████████████                  | 870M/1.65G [00:19&lt;00:19, 40.0MB/s]
 53%|████████████████████▏                 | 877M/1.65G [00:19&lt;00:16, 45.7MB/s]
 53%|████████████████████▎                 | 882M/1.65G [00:20&lt;00:22, 34.4MB/s]
 54%|████████████████████▍                 | 889M/1.65G [00:20&lt;00:18, 40.5MB/s]
 54%|████████████████████▌                 | 894M/1.65G [00:20&lt;00:17, 42.4MB/s]
 54%|████████████████████▋                 | 899M/1.65G [00:20&lt;00:16, 45.5MB/s]
 55%|████████████████████▊                 | 904M/1.65G [00:20&lt;00:24, 30.7MB/s]
 55%|████████████████████▉                 | 909M/1.65G [00:20&lt;00:21, 33.9MB/s]
 55%|█████████████████████                 | 913M/1.65G [00:21&lt;00:30, 24.2MB/s]
 55%|█████████████████████                 | 917M/1.65G [00:21&lt;00:29, 24.6MB/s]
 56%|█████████████████████▏                | 920M/1.65G [00:21&lt;00:28, 25.9MB/s]
 56%|█████████████████████▎                | 925M/1.65G [00:21&lt;00:24, 30.0MB/s]
 56%|█████████████████████▎                | 928M/1.65G [00:21&lt;00:30, 24.0MB/s]
 57%|█████████████████████▍                | 934M/1.65G [00:21&lt;00:22, 31.6MB/s]
 57%|█████████████████████▋                | 942M/1.65G [00:21&lt;00:17, 41.1MB/s]
 57%|█████████████████████▊                | 950M/1.65G [00:21&lt;00:13, 50.5MB/s]
 58%|██████████████████████                | 958M/1.65G [00:22&lt;00:11, 59.0MB/s]
 58%|██████████████████████▏               | 966M/1.65G [00:22&lt;00:10, 66.0MB/s]
 59%|██████████████████████▍               | 975M/1.65G [00:22&lt;00:09, 71.4MB/s]
 59%|██████████████████████▌               | 983M/1.65G [00:22&lt;00:18, 37.1MB/s]
 60%|██████████████████████▋               | 988M/1.65G [00:23&lt;00:26, 24.8MB/s]
 60%|██████████████████████▊               | 995M/1.65G [00:23&lt;00:22, 29.9MB/s]
 61%|██████████████████████▍              | 1.00G/1.65G [00:23&lt;00:18, 36.1MB/s]
 61%|██████████████████████▌              | 1.01G/1.65G [00:23&lt;00:14, 45.2MB/s]
 62%|██████████████████████▊              | 1.02G/1.65G [00:23&lt;00:12, 49.6MB/s]
 62%|██████████████████████▉              | 1.02G/1.65G [00:23&lt;00:11, 54.7MB/s]
 62%|███████████████████████              | 1.03G/1.65G [00:23&lt;00:10, 61.4MB/s]
 63%|███████████████████████▎             | 1.04G/1.65G [00:23&lt;00:09, 67.5MB/s]
 63%|███████████████████████▍             | 1.05G/1.65G [00:24&lt;00:20, 29.1MB/s]
 64%|███████████████████████▌             | 1.05G/1.65G [00:25&lt;00:35, 16.8MB/s]
 64%|███████████████████████▋             | 1.06G/1.65G [00:25&lt;00:33, 17.6MB/s]
 64%|███████████████████████▊             | 1.06G/1.65G [00:25&lt;00:27, 21.1MB/s]
 65%|███████████████████████▉             | 1.07G/1.65G [00:25&lt;00:21, 26.8MB/s]
 65%|████████████████████████             | 1.07G/1.65G [00:25&lt;00:21, 26.3MB/s]
 65%|████████████████████████▏            | 1.08G/1.65G [00:26&lt;00:22, 25.9MB/s]
 66%|████████████████████████▎            | 1.09G/1.65G [00:26&lt;00:16, 33.6MB/s]
 66%|████████████████████████▍            | 1.09G/1.65G [00:26&lt;00:16, 35.1MB/s]
 66%|████████████████████████▍            | 1.09G/1.65G [00:26&lt;00:15, 37.0MB/s]
 66%|████████████████████████▌            | 1.10G/1.65G [00:26&lt;00:14, 38.9MB/s]
 67%|████████████████████████▋            | 1.10G/1.65G [00:26&lt;00:24, 22.1MB/s]
 67%|████████████████████████▊            | 1.11G/1.65G [00:26&lt;00:18, 28.9MB/s]
 68%|█████████████████████████            | 1.12G/1.65G [00:27&lt;00:14, 37.6MB/s]
 68%|█████████████████████████▏           | 1.12G/1.65G [00:27&lt;00:13, 38.9MB/s]
 68%|█████████████████████████▏           | 1.13G/1.65G [00:27&lt;00:17, 30.8MB/s]
 68%|█████████████████████████▎           | 1.13G/1.65G [00:27&lt;00:18, 28.2MB/s]
 69%|█████████████████████████▍           | 1.13G/1.65G [00:27&lt;00:19, 26.4MB/s]
 69%|█████████████████████████▍           | 1.14G/1.65G [00:27&lt;00:19, 27.0MB/s]
 69%|█████████████████████████▌           | 1.14G/1.65G [00:27&lt;00:16, 31.7MB/s]
 69%|█████████████████████████▋           | 1.15G/1.65G [00:28&lt;00:15, 31.7MB/s]
 70%|█████████████████████████▊           | 1.15G/1.65G [00:28&lt;00:19, 25.9MB/s]
 70%|█████████████████████████▉           | 1.16G/1.65G [00:28&lt;00:14, 33.2MB/s]
 70%|█████████████████████████▉           | 1.16G/1.65G [00:28&lt;00:14, 34.6MB/s]
 70%|██████████████████████████           | 1.16G/1.65G [00:28&lt;00:20, 24.3MB/s]
 71%|██████████████████████████▏          | 1.17G/1.65G [00:28&lt;00:19, 25.1MB/s]
 71%|██████████████████████████▎          | 1.17G/1.65G [00:29&lt;00:14, 33.5MB/s]
 71%|██████████████████████████▍          | 1.18G/1.65G [00:29&lt;00:10, 44.6MB/s]
 72%|██████████████████████████▌          | 1.19G/1.65G [00:29&lt;00:13, 34.5MB/s]
 72%|██████████████████████████▋          | 1.19G/1.65G [00:29&lt;00:12, 36.9MB/s]
 72%|██████████████████████████▊          | 1.20G/1.65G [00:29&lt;00:11, 41.1MB/s]
 73%|██████████████████████████▉          | 1.20G/1.65G [00:29&lt;00:13, 32.6MB/s]
 73%|███████████████████████████          | 1.21G/1.65G [00:29&lt;00:10, 40.8MB/s]
 74%|███████████████████████████▏         | 1.22G/1.65G [00:29&lt;00:08, 48.5MB/s]
 74%|███████████████████████████▍         | 1.22G/1.65G [00:30&lt;00:07, 57.3MB/s]
 74%|███████████████████████████▌         | 1.23G/1.65G [00:30&lt;00:07, 56.4MB/s]
 75%|███████████████████████████▋         | 1.24G/1.65G [00:30&lt;00:10, 38.8MB/s]
 75%|███████████████████████████▊         | 1.24G/1.65G [00:30&lt;00:14, 27.5MB/s]
 75%|███████████████████████████▉         | 1.25G/1.65G [00:31&lt;00:16, 25.2MB/s]
 76%|████████████████████████████         | 1.25G/1.65G [00:31&lt;00:13, 29.2MB/s]
 76%|████████████████████████████         | 1.25G/1.65G [00:31&lt;00:16, 23.6MB/s]
 76%|████████████████████████████▏        | 1.26G/1.65G [00:31&lt;00:16, 24.0MB/s]
 77%|████████████████████████████▎        | 1.26G/1.65G [00:31&lt;00:11, 32.4MB/s]
 77%|████████████████████████████▍        | 1.27G/1.65G [00:31&lt;00:15, 25.5MB/s]
 77%|████████████████████████████▍        | 1.27G/1.65G [00:31&lt;00:14, 26.7MB/s]
 77%|████████████████████████████▌        | 1.28G/1.65G [00:32&lt;00:16, 23.5MB/s]
 77%|████████████████████████████▋        | 1.28G/1.65G [00:32&lt;00:12, 29.9MB/s]
 78%|████████████████████████████▊        | 1.28G/1.65G [00:32&lt;00:12, 28.6MB/s]
 78%|████████████████████████████▉        | 1.29G/1.65G [00:32&lt;00:09, 37.0MB/s]
 78%|█████████████████████████████        | 1.30G/1.65G [00:32&lt;00:08, 41.8MB/s]
 79%|█████████████████████████████▏       | 1.30G/1.65G [00:32&lt;00:07, 48.9MB/s]
 79%|█████████████████████████████▎       | 1.31G/1.65G [00:32&lt;00:06, 53.4MB/s]
 80%|█████████████████████████████▍       | 1.32G/1.65G [00:32&lt;00:06, 51.7MB/s]
 80%|█████████████████████████████▋       | 1.32G/1.65G [00:33&lt;00:05, 57.5MB/s]
 80%|█████████████████████████████▊       | 1.33G/1.65G [00:33&lt;00:05, 56.9MB/s]
 81%|█████████████████████████████▉       | 1.34G/1.65G [00:33&lt;00:05, 60.7MB/s]
 81%|██████████████████████████████       | 1.34G/1.65G [00:33&lt;00:04, 65.5MB/s]
 82%|██████████████████████████████▏      | 1.35G/1.65G [00:33&lt;00:06, 48.9MB/s]
 82%|██████████████████████████████▎      | 1.36G/1.65G [00:33&lt;00:07, 37.4MB/s]
 82%|██████████████████████████████▍      | 1.36G/1.65G [00:33&lt;00:07, 41.4MB/s]
 83%|██████████████████████████████▌      | 1.37G/1.65G [00:34&lt;00:06, 43.1MB/s]
 83%|██████████████████████████████▋      | 1.37G/1.65G [00:34&lt;00:06, 45.1MB/s]
 83%|██████████████████████████████▊      | 1.38G/1.65G [00:34&lt;00:08, 31.8MB/s]
 84%|██████████████████████████████▉      | 1.38G/1.65G [00:34&lt;00:08, 33.3MB/s]
 84%|███████████████████████████████      | 1.39G/1.65G [00:34&lt;00:13, 19.8MB/s]
 84%|███████████████████████████████      | 1.39G/1.65G [00:35&lt;00:15, 16.5MB/s]
 84%|███████████████████████████████▏     | 1.39G/1.65G [00:35&lt;00:16, 16.1MB/s]
 85%|███████████████████████████████▎     | 1.40G/1.65G [00:35&lt;00:10, 24.9MB/s]
 85%|███████████████████████████████▍     | 1.41G/1.65G [00:35&lt;00:07, 33.2MB/s]
 85%|███████████████████████████████▌     | 1.41G/1.65G [00:36&lt;00:11, 21.0MB/s]
 86%|███████████████████████████████▋     | 1.42G/1.65G [00:36&lt;00:08, 27.4MB/s]
 86%|███████████████████████████████▊     | 1.42G/1.65G [00:36&lt;00:10, 22.4MB/s]
 86%|███████████████████████████████▉     | 1.43G/1.65G [00:36&lt;00:09, 24.3MB/s]
 87%|████████████████████████████████     | 1.43G/1.65G [00:36&lt;00:07, 30.0MB/s]
 87%|████████████████████████████████▏    | 1.44G/1.65G [00:36&lt;00:06, 35.7MB/s]
 87%|████████████████████████████████▎    | 1.44G/1.65G [00:36&lt;00:04, 43.3MB/s]
 88%|████████████████████████████████▍    | 1.45G/1.65G [00:37&lt;00:04, 48.3MB/s]
 88%|████████████████████████████████▋    | 1.46G/1.65G [00:37&lt;00:03, 55.6MB/s]
 89%|████████████████████████████████▊    | 1.47G/1.65G [00:37&lt;00:03, 60.4MB/s]
 89%|████████████████████████████████▉    | 1.47G/1.65G [00:37&lt;00:02, 65.4MB/s]
 90%|█████████████████████████████████▏   | 1.48G/1.65G [00:37&lt;00:03, 44.1MB/s]
 90%|█████████████████████████████████▎   | 1.49G/1.65G [00:37&lt;00:03, 45.5MB/s]
 90%|█████████████████████████████████▍   | 1.49G/1.65G [00:37&lt;00:03, 50.8MB/s]
 91%|█████████████████████████████████▌   | 1.50G/1.65G [00:37&lt;00:02, 53.4MB/s]
 91%|█████████████████████████████████▋   | 1.51G/1.65G [00:38&lt;00:02, 59.2MB/s]
 92%|█████████████████████████████████▉   | 1.51G/1.65G [00:38&lt;00:02, 63.7MB/s]
 92%|██████████████████████████████████   | 1.52G/1.65G [00:38&lt;00:04, 32.7MB/s]
 92%|██████████████████████████████████▏  | 1.53G/1.65G [00:39&lt;00:05, 21.7MB/s]
 93%|██████████████████████████████████▎  | 1.53G/1.65G [00:39&lt;00:04, 26.3MB/s]
 93%|██████████████████████████████████▍  | 1.54G/1.65G [00:39&lt;00:03, 32.7MB/s]
 94%|██████████████████████████████████▌  | 1.55G/1.65G [00:39&lt;00:02, 40.0MB/s]
 94%|██████████████████████████████████▋  | 1.55G/1.65G [00:39&lt;00:03, 28.6MB/s]
 94%|██████████████████████████████████▊  | 1.56G/1.65G [00:39&lt;00:02, 32.3MB/s]
 95%|██████████████████████████████████▉  | 1.56G/1.65G [00:39&lt;00:02, 37.3MB/s]
 95%|███████████████████████████████████  | 1.57G/1.65G [00:40&lt;00:02, 40.4MB/s]
 95%|███████████████████████████████████▎ | 1.57G/1.65G [00:40&lt;00:01, 47.4MB/s]
 96%|███████████████████████████████████▍ | 1.58G/1.65G [00:40&lt;00:01, 49.4MB/s]
 96%|███████████████████████████████████▌ | 1.59G/1.65G [00:40&lt;00:02, 29.3MB/s]
 96%|███████████████████████████████████▋ | 1.59G/1.65G [00:40&lt;00:01, 36.0MB/s]
 97%|███████████████████████████████████▊ | 1.60G/1.65G [00:40&lt;00:01, 27.7MB/s]
 97%|███████████████████████████████████▊ | 1.60G/1.65G [00:41&lt;00:02, 22.1MB/s]
 97%|███████████████████████████████████▉ | 1.61G/1.65G [00:41&lt;00:02, 23.2MB/s]
 97%|████████████████████████████████████ | 1.61G/1.65G [00:41&lt;00:01, 26.5MB/s]
 98%|████████████████████████████████████▏| 1.61G/1.65G [00:41&lt;00:01, 31.2MB/s]
 98%|████████████████████████████████████▏| 1.62G/1.65G [00:41&lt;00:01, 22.7MB/s]
 98%|████████████████████████████████████▎| 1.62G/1.65G [00:42&lt;00:00, 28.8MB/s]
 99%|████████████████████████████████████▍| 1.63G/1.65G [00:42&lt;00:01, 19.1MB/s]
 99%|████████████████████████████████████▌| 1.63G/1.65G [00:42&lt;00:01, 15.3MB/s]
 99%|████████████████████████████████████▋| 1.64G/1.65G [00:42&lt;00:00, 20.3MB/s]
 99%|████████████████████████████████████▋| 1.64G/1.65G [00:42&lt;00:00, 23.5MB/s]
 99%|████████████████████████████████████▊| 1.64G/1.65G [00:43&lt;00:00, 17.8MB/s]
100%|████████████████████████████████████▉| 1.65G/1.65G [00:43&lt;00:00, 24.0MB/s]
  0%|                                              | 0.00/1.65G [00:00&lt;?, ?B/s]
100%|█████████████████████████████████████| 1.65G/1.65G [00:00&lt;00:00, 9.00TB/s]
Download complete in 01m15s (1576.2 MB)
NOTE: pick_types() is a legacy function. New code should use inst.pick(...).
done
</pre></div>
</div>
<p>Then, we remove the powerline artifacts and high-pass filter to remove the
drift which can impact the CSC technique. The signal is also resampled to
150 Hz to reduce the computationnal burden.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preprocessing the data...&quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">flush</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a href="https://mne.tools/stable/generated/mne.io.Raw.html#mne.io.Raw.notch_filter" title="mne.io.Raw.notch_filter" class="sphx-glr-backref-module-mne-io sphx-glr-backref-type-py-method"><span class="n">raw</span><span class="o">.</span><span class="n">notch_filter</span></a><span class="p">(</span><a href="https://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.arange.html#numpy.arange" title="numpy.arange" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">arange</span></a><span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mi">181</span><span class="p">,</span> <span class="mi">60</span><span class="p">),</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">n_jobs</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">n_jobs</span></a><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<a href="https://mne.tools/stable/generated/mne.io.Raw.html#mne.io.Raw.filter" title="mne.io.Raw.filter" class="sphx-glr-backref-module-mne-io sphx-glr-backref-type-py-method"><span class="n">raw</span><span class="o">.</span><span class="n">filter</span></a><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">n_jobs</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">n_jobs</span></a><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<a href="https://mne.tools/stable/generated/mne.io.Raw.html#mne.io.Raw" title="mne.io.Raw" class="sphx-glr-backref-module-mne-io sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">raw</span></a> <span class="o">=</span> <a href="https://mne.tools/stable/generated/mne.io.Raw.html#mne.io.Raw.resample" title="mne.io.Raw.resample" class="sphx-glr-backref-module-mne-io sphx-glr-backref-type-py-method"><span class="n">raw</span><span class="o">.</span><span class="n">resample</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">sfreq</span></a><span class="p">,</span> <span class="n">npad</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">n_jobs</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">n_jobs</span></a><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;done&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Preprocessing the data.../github/workspace/examples/multicsc/plot_sample_evoked_response.py:115: RuntimeWarning: Resampling of the stim channels caused event information to become unreliable. Consider finding events on the original data and passing the event matrix as a parameter.
  raw = raw.resample(sfreq, npad=&#39;auto&#39;, n_jobs=n_jobs, verbose=False)
done
</pre></div>
</div>
<p>Load the data as an array and split it in chunks to allow parallel processing
during the model fit. Each split is considered as independent.
To reduce the impact of border artifacts, we use <cite>apply_window=True</cite>
which scales down the border of each split with a tukey window.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">alphacsc.utils.signal</span><span class="w"> </span><span class="kn">import</span> <a href="../../generated/alphacsc.utils.signal.split_signal.html#alphacsc.utils.signal.split_signal" title="alphacsc.utils.signal.split_signal" class="sphx-glr-backref-module-alphacsc-utils-signal sphx-glr-backref-type-py-function"><span class="n">split_signal</span></a>

<a href="https://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">X</span></a> <span class="o">=</span> <a href="https://mne.tools/stable/generated/mne.io.Raw.html#mne.io.Raw.get_data" title="mne.io.Raw.get_data" class="sphx-glr-backref-module-mne-io sphx-glr-backref-type-py-method"><span class="n">raw</span><span class="o">.</span><span class="n">get_data</span></a><span class="p">(</span><span class="n">picks</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;meg&#39;</span><span class="p">])</span>
<a href="https://mne.tools/stable/generated/mne.Info.html#mne.Info" title="mne._fiff.meas_info.Info" class="sphx-glr-backref-module-mne-_fiff-meas_info sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">info</span></a> <span class="o">=</span> <a href="https://mne.tools/stable/generated/mne.io.Raw.html#mne.io.Raw.copy" title="mne.io.Raw.copy" class="sphx-glr-backref-module-mne-io sphx-glr-backref-type-py-method"><span class="n">raw</span><span class="o">.</span><span class="n">copy</span></a><span class="p">()</span><span class="o">.</span><span class="n">pick_types</span><span class="p">(</span><span class="n">meg</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><a href="https://mne.tools/stable/generated/mne.Info.html#mne.Info" title="mne._fiff.meas_info.Info" class="sphx-glr-backref-module-mne-_fiff-meas_info sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">info</span></a>  <span class="c1"># info of the loaded channels</span>
<a href="https://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">X_split</span></a> <span class="o">=</span> <a href="../../generated/alphacsc.utils.signal.split_signal.html#alphacsc.utils.signal.split_signal" title="alphacsc.utils.signal.split_signal" class="sphx-glr-backref-module-alphacsc-utils-signal sphx-glr-backref-type-py-function"><span class="n">split_signal</span></a><span class="p">(</span><a href="https://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">X</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">n_splits</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">n_splits</span></a><span class="p">,</span> <span class="n">apply_window</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>NOTE: pick_types() is a legacy function. New code should use inst.pick(...).
</pre></div>
</div>
<p>Fit the model and learn rank1 atoms</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="../../generated/alphacsc.GreedyCDL.html#alphacsc.GreedyCDL" title="alphacsc.GreedyCDL" class="sphx-glr-backref-module-alphacsc sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">cdl</span></a><span class="o">.</span><span class="n">fit</span><span class="p">(</span><a href="https://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">X_split</span></a><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>.................................................+
......
[GreedyCDL] Converged after 56 iteration, (dz, du) = 6.867e-05, 9.388e-05
[GreedyCDL] Fit in 1366.8s

&lt;alphacsc.convolutional_dictionary_learning.GreedyCDL object at 0x7f6123e55550&gt;
</pre></div>
</div>
<p>Then we call the <cite>transform</cite> method, which returns the sparse codes
associated with X, without changing the dictionary learned during the <cite>fit</cite>.
Note that we transform on the <em>unsplit</em> data so that the sparse codes
reflect the original data and not the windowed data.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">z_hat</span></a> <span class="o">=</span> <a href="../../generated/alphacsc.GreedyCDL.html#alphacsc.GreedyCDL" title="alphacsc.GreedyCDL" class="sphx-glr-backref-module-alphacsc sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">cdl</span></a><span class="o">.</span><span class="n">transform</span><span class="p">(</span><a href="https://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">X</span></a><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="p">:])</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Refitting the activation to avoid amplitude bias...done
</pre></div>
</div>
<section id="display-a-selection-of-atoms">
<h2>Display a selection of atoms<a class="headerlink" href="#display-a-selection-of-atoms" title="Link to this heading">#</a></h2>
<p>We recognize a heartbeat artifact, an eyeblink artifact, two atoms of evoked
responses, and a non-sinusoidal oscillation.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="c1"># preselected atoms of interest</span>
<a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">plotted_atoms</span></a> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>

<a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">n_plots</span></a> <span class="o">=</span> <span class="mi">3</span>  <span class="c1"># number of plots by atom</span>
<a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">n_columns</span></a> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">plotted_atoms</span></a><span class="p">))</span>
<a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">split</span></a> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><a href="https://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.ceil.html#numpy.ceil" title="numpy.ceil" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-data"><span class="n">np</span><span class="o">.</span><span class="n">ceil</span></a><span class="p">(</span><span class="nb">len</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">plotted_atoms</span></a><span class="p">)</span> <span class="o">/</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">n_columns</span></a><span class="p">))</span>
<a href="https://docs.python.org/3/library/stdtypes.html#tuple" title="builtins.tuple" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">figsize</span></a> <span class="o">=</span> <span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">n_columns</span></a><span class="p">,</span> <span class="mi">3</span> <span class="o">*</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">n_plots</span></a> <span class="o">*</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">split</span></a><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <a href="https://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">axes</span></a> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">n_plots</span></a> <span class="o">*</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">split</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">n_columns</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#tuple" title="builtins.tuple" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">figsize</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#tuple" title="builtins.tuple" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">figsize</span></a><span class="p">)</span>
<span class="k">for</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ii</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">kk</span></a> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">plotted_atoms</span></a><span class="p">):</span>

    <span class="c1"># Select the axes to display the current atom</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\r</span><span class="s2">Displaying </span><span class="si">{}</span><span class="s2">-th atom&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">kk</span></a><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">flush</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">i_row</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">i_col</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ii</span></a> <span class="o">//</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">n_columns</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ii</span></a> <span class="o">%</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">n_columns</span></a>
    <span class="n">it_axes</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><a href="https://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">axes</span></a><span class="p">[</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">i_row</span></a> <span class="o">*</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">n_plots</span></a><span class="p">:(</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">i_row</span></a> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">n_plots</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">i_col</span></a><span class="p">])</span>

    <span class="c1"># Select the current atom</span>
    <a href="https://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">u_k</span></a> <span class="o">=</span> <a href="../../generated/alphacsc.GreedyCDL.html#alphacsc.GreedyCDL" title="alphacsc.GreedyCDL" class="sphx-glr-backref-module-alphacsc sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">cdl</span></a><span class="o">.</span><span class="n">u_hat_</span><span class="p">[</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">kk</span></a><span class="p">]</span>
    <a href="https://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">v_k</span></a> <span class="o">=</span> <a href="../../generated/alphacsc.GreedyCDL.html#alphacsc.GreedyCDL" title="alphacsc.GreedyCDL" class="sphx-glr-backref-module-alphacsc sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">cdl</span></a><span class="o">.</span><span class="n">v_hat_</span><span class="p">[</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">kk</span></a><span class="p">]</span>

    <span class="c1"># Plot the spatial map of the atom using mne topomap</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">it_axes</span><span class="p">)</span>
    <a href="https://mne.tools/stable/generated/mne.viz.plot_topomap.html#mne.viz.plot_topomap" title="mne.viz.plot_topomap" class="sphx-glr-backref-module-mne-viz sphx-glr-backref-type-py-function"><span class="n">mne</span><span class="o">.</span><span class="n">viz</span><span class="o">.</span><span class="n">plot_topomap</span></a><span class="p">(</span><a href="https://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">u_k</span></a><span class="p">,</span> <a href="https://mne.tools/stable/generated/mne.Info.html#mne.Info" title="mne._fiff.meas_info.Info" class="sphx-glr-backref-module-mne-_fiff-meas_info sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">info</span></a><span class="p">,</span> <a href="https://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">axes</span></a><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Spatial pattern </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">kk</span></a><span class="p">,</span> <span class="p">))</span>

    <span class="c1"># Plot the temporal pattern of the atom</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">it_axes</span><span class="p">)</span>
    <a href="https://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">t</span></a> <span class="o">=</span> <a href="https://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.arange.html#numpy.arange" title="numpy.arange" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">arange</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">n_times_atom</span></a><span class="p">)</span> <span class="o">/</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">sfreq</span></a>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">t</span></a><span class="p">,</span> <a href="https://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">v_k</span></a><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">n_times_atom</span></a> <span class="o">/</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">sfreq</span></a><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Time (sec)&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Temporal pattern </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">kk</span></a><span class="p">)</span>

    <span class="c1"># Plot the power spectral density (PSD)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">it_axes</span><span class="p">)</span>
    <a href="https://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">psd</span></a> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><a href="https://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.fft.rfft.html#numpy.fft.rfft" title="numpy.fft.rfft" class="sphx-glr-backref-module-numpy-fft sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">rfft</span></a><span class="p">(</span><a href="https://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">v_k</span></a><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">256</span><span class="p">))</span> <span class="o">**</span> <span class="mi">2</span>
    <a href="https://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">frequencies</span></a> <span class="o">=</span> <a href="https://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.linspace.html#numpy.linspace" title="numpy.linspace" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">linspace</span></a><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">sfreq</span></a> <span class="o">/</span> <span class="mf">2.0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><a href="https://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">psd</span></a><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><a href="https://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">frequencies</span></a><span class="p">,</span> <a href="https://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">psd</span></a><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;PSD&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Frequencies (Hz)&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Power spectral density </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">kk</span></a><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mf">1e-4</span><span class="p">,</span> <span class="mf">1e2</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\r</span><span class="s2">Displayed </span><span class="si">{}</span><span class="s2"> atoms&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">plotted_atoms</span></a><span class="p">))</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="mi">40</span><span class="p">))</span>

<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_sample_evoked_response_001.png" srcset="../../_images/sphx_glr_plot_sample_evoked_response_001.png" alt="Spatial pattern 0, Spatial pattern 1, Spatial pattern 2, Spatial pattern 6, Spatial pattern 4, Temporal pattern 0, Temporal pattern 1, Temporal pattern 2, Temporal pattern 6, Temporal pattern 4, Power spectral density 0, Power spectral density 1, Power spectral density 2, Power spectral density 6, Power spectral density 4" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Displaying 0-th atom
Displaying 1-th atom
Displaying 2-th atom
Displaying 6-th atom
Displaying 4-th atom
Displayed 5 atoms
</pre></div>
</div>
</section>
<section id="display-the-evoked-reconstructed-envelope">
<h2>Display the evoked reconstructed envelope<a class="headerlink" href="#display-the-evoked-reconstructed-envelope" title="Link to this heading">#</a></h2>
<p>The MNE sample data contains data for auditory (event_id=1 and 2) and
visual stimuli (event_id=3 and 4). We extract the events now so that we can
later identify the atoms related to different events. Note that the
convolutional sparse coding method does not need to know the events for
learning atoms.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">event_id</span></a> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
<a href="https://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">events</span></a> <span class="o">=</span> <a href="https://mne.tools/stable/generated/mne.find_events.html#mne.find_events" title="mne.find_events" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-function"><span class="n">mne</span><span class="o">.</span><span class="n">find_events</span></a><span class="p">(</span><a href="https://mne.tools/stable/generated/mne.io.Raw.html#mne.io.Raw" title="mne.io.Raw" class="sphx-glr-backref-module-mne-io sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">raw</span></a><span class="p">,</span> <span class="n">stim_channel</span><span class="o">=</span><span class="s1">&#39;STI 014&#39;</span><span class="p">)</span>
<a href="https://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">events</span></a> <span class="o">=</span> <a href="https://mne.tools/stable/generated/mne.pick_events.html#mne.pick_events" title="mne.pick_events" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-function"><span class="n">mne</span><span class="o">.</span><span class="n">pick_events</span></a><span class="p">(</span><a href="https://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">events</span></a><span class="p">,</span> <span class="n">include</span><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">event_id</span></a><span class="p">)</span>
<a href="https://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">events</span></a><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">-=</span> <a href="https://mne.tools/stable/generated/mne.io.Raw.html#mne.io.Raw.first_samp" title="mne.io.Raw.first_samp" class="sphx-glr-backref-module-mne-io sphx-glr-backref-type-py-property"><span class="n">raw</span><span class="o">.</span><span class="n">first_samp</span></a>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>319 events found on stim channel STI 014
Event IDs: [ 1  2  3  4  5 32]
</pre></div>
</div>
<p>For each atom (columns), and for each event (rows), we compute the envelope
of the reconstructed signal, align it with respect to the event onsets, and
take the average. For some atoms, the activations are correlated with the
events, leading to a large evoked envelope. The gray area corresponds to
not statistically significant values, computing with sampling.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">alphacsc.utils.signal</span><span class="w"> </span><span class="kn">import</span> <span class="n">fast_hilbert</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">alphacsc.viz.epoch</span><span class="w"> </span><span class="kn">import</span> <span class="n">plot_evoked_surrogates</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">alphacsc.utils.convolution</span><span class="w"> </span><span class="kn">import</span> <span class="n">construct_X_multi</span>

<span class="c1"># time window around the events. Note that for the sample datasets, the time</span>
<span class="c1"># inter-event is around 0.5s</span>
<a href="https://docs.python.org/3/library/stdtypes.html#tuple" title="builtins.tuple" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">t_lim</span></a> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>

<a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">n_plots</span></a> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">event_id</span></a><span class="p">)</span>
<a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">n_columns</span></a> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">plotted_atoms</span></a><span class="p">))</span>
<a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">split</span></a> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><a href="https://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.ceil.html#numpy.ceil" title="numpy.ceil" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-data"><span class="n">np</span><span class="o">.</span><span class="n">ceil</span></a><span class="p">(</span><span class="nb">len</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">plotted_atoms</span></a><span class="p">)</span> <span class="o">/</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">n_columns</span></a><span class="p">))</span>
<a href="https://docs.python.org/3/library/stdtypes.html#tuple" title="builtins.tuple" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">figsize</span></a> <span class="o">=</span> <span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">n_columns</span></a><span class="p">,</span> <span class="mi">3</span> <span class="o">*</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">n_plots</span></a> <span class="o">*</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">split</span></a><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <a href="https://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">axes</span></a> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">n_plots</span></a> <span class="o">*</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">split</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">n_columns</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#tuple" title="builtins.tuple" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">figsize</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#tuple" title="builtins.tuple" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">figsize</span></a><span class="p">)</span>

<span class="k">for</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ii</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">kk</span></a> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">plotted_atoms</span></a><span class="p">):</span>

    <span class="c1"># Select the axes to display the current atom</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\r</span><span class="s2">Displaying </span><span class="si">{}</span><span class="s2">-th atom envelope&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">kk</span></a><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">flush</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">i_row</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">i_col</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ii</span></a> <span class="o">//</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">n_columns</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ii</span></a> <span class="o">%</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">n_columns</span></a>
    <span class="n">it_axes</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><a href="https://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">axes</span></a><span class="p">[</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">i_row</span></a> <span class="o">*</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">n_plots</span></a><span class="p">:(</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">i_row</span></a> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">n_plots</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">i_col</span></a><span class="p">])</span>

    <span class="c1"># Select the current atom</span>
    <a href="https://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">v_k</span></a> <span class="o">=</span> <a href="../../generated/alphacsc.GreedyCDL.html#alphacsc.GreedyCDL" title="alphacsc.GreedyCDL" class="sphx-glr-backref-module-alphacsc sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">cdl</span></a><span class="o">.</span><span class="n">v_hat_</span><span class="p">[</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">kk</span></a><span class="p">]</span>
    <a href="https://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">v_k_1</span></a> <span class="o">=</span> <a href="https://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.r_.html#numpy.r_" title="numpy.r_" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-data"><span class="n">np</span><span class="o">.</span><span class="n">r_</span></a><span class="p">[[</span><span class="mi">1</span><span class="p">],</span> <a href="https://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">v_k</span></a><span class="p">][</span><span class="kc">None</span><span class="p">]</span>
    <a href="https://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">z_k</span></a> <span class="o">=</span> <a href="https://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">z_hat</span></a><span class="p">[:,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">kk</span></a><span class="p">:</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">kk</span></a> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
    <a href="https://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">X_k</span></a> <span class="o">=</span> <span class="n">construct_X_multi</span><span class="p">(</span><a href="https://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">z_k</span></a><span class="p">,</span> <a href="https://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">v_k_1</span></a><span class="p">,</span> <span class="n">n_channels</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>

    <span class="c1"># compute the &#39;envelope&#39; of the reconstructed signal X_k</span>
    <a href="https://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">correlation</span></a> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">fast_hilbert</span><span class="p">(</span><a href="https://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">X_k</span></a><span class="p">))</span>

    <span class="c1"># loop over all events IDs</span>
    <span class="k">for</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">this_event_id</span></a> <span class="ow">in</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">event_id</span></a><span class="p">:</span>
        <a href="https://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">this_events</span></a> <span class="o">=</span> <a href="https://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">events</span></a><span class="p">[</span><a href="https://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">events</span></a><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">this_event_id</span></a><span class="p">]</span>
        <span class="c1"># plotting function</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">it_axes</span><span class="p">)</span>
        <a href="https://mne.tools/stable/generated/mne.Info.html#mne.Info" title="mne._fiff.meas_info.Info" class="sphx-glr-backref-module-mne-_fiff-meas_info sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">this_info</span></a> <span class="o">=</span> <a href="https://mne.tools/stable/generated/mne.Info.html#mne.Info.copy" title="mne.Info.copy" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-method"><span class="n">info</span><span class="o">.</span><span class="n">copy</span></a><span class="p">()</span>
        <a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">event_info</span></a> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">event_id</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">this_event_id</span></a><span class="p">,</span> <a href="https://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">events</span></a><span class="o">=</span><a href="https://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">events</span></a><span class="p">)</span>
        <a href="https://mne.tools/stable/generated/mne.Info.html#mne.Info" title="mne._fiff.meas_info.Info" class="sphx-glr-backref-module-mne-_fiff-meas_info sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">this_info</span></a><span class="p">[</span><span class="s1">&#39;temp&#39;</span><span class="p">]</span> <span class="o">=</span> <a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">event_info</span></a>
        <span class="n">plot_evoked_surrogates</span><span class="p">(</span><a href="https://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">correlation</span></a><span class="p">,</span> <a href="https://mne.tools/stable/generated/mne.Info.html#mne.Info" title="mne._fiff.meas_info.Info" class="sphx-glr-backref-module-mne-_fiff-meas_info sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">info</span></a><span class="o">=</span><a href="https://mne.tools/stable/generated/mne.Info.html#mne.Info" title="mne._fiff.meas_info.Info" class="sphx-glr-backref-module-mne-_fiff-meas_info sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">this_info</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#tuple" title="builtins.tuple" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">t_lim</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#tuple" title="builtins.tuple" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">t_lim</span></a><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
                               <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">n_jobs</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">n_jobs</span></a><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;event </span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">this_event_id</span></a><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Time (sec)&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Evoked envelope </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">kk</span></a><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\r</span><span class="s2">Displayed </span><span class="si">{}</span><span class="s2"> atoms&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">plotted_atoms</span></a><span class="p">))</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="mi">40</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_sample_evoked_response_002.png" srcset="../../_images/sphx_glr_plot_sample_evoked_response_002.png" alt="Evoked envelope 0, Evoked envelope 1, Evoked envelope 2, Evoked envelope 6, Evoked envelope 4, Evoked envelope 0, Evoked envelope 1, Evoked envelope 2, Evoked envelope 6, Evoked envelope 4, Evoked envelope 0, Evoked envelope 1, Evoked envelope 2, Evoked envelope 6, Evoked envelope 4, Evoked envelope 0, Evoked envelope 1, Evoked envelope 2, Evoked envelope 6, Evoked envelope 4" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Displaying 0-th atom envelopeUsing data from preloaded Raw for 72 events and 91 original time points ...
0 bad epochs dropped
Using data from preloaded Raw for 73 events and 91 original time points ...
0 bad epochs dropped
Using data from preloaded Raw for 73 events and 91 original time points ...
0 bad epochs dropped
Using data from preloaded Raw for 70 events and 91 original time points ...
0 bad epochs dropped

Displaying 1-th atom envelopeUsing data from preloaded Raw for 72 events and 91 original time points ...
0 bad epochs dropped
Using data from preloaded Raw for 73 events and 91 original time points ...
0 bad epochs dropped
Using data from preloaded Raw for 73 events and 91 original time points ...
0 bad epochs dropped
Using data from preloaded Raw for 70 events and 91 original time points ...
0 bad epochs dropped

Displaying 2-th atom envelopeUsing data from preloaded Raw for 72 events and 91 original time points ...
0 bad epochs dropped
Using data from preloaded Raw for 73 events and 91 original time points ...
0 bad epochs dropped
Using data from preloaded Raw for 73 events and 91 original time points ...
0 bad epochs dropped
Using data from preloaded Raw for 70 events and 91 original time points ...
0 bad epochs dropped

Displaying 6-th atom envelopeUsing data from preloaded Raw for 72 events and 91 original time points ...
0 bad epochs dropped
Using data from preloaded Raw for 73 events and 91 original time points ...
0 bad epochs dropped
Using data from preloaded Raw for 73 events and 91 original time points ...
0 bad epochs dropped
Using data from preloaded Raw for 70 events and 91 original time points ...
0 bad epochs dropped

Displaying 4-th atom envelopeUsing data from preloaded Raw for 72 events and 91 original time points ...
0 bad epochs dropped
Using data from preloaded Raw for 73 events and 91 original time points ...
0 bad epochs dropped
Using data from preloaded Raw for 73 events and 91 original time points ...
0 bad epochs dropped
Using data from preloaded Raw for 70 events and 91 original time points ...
0 bad epochs dropped

Displayed 5 atoms
</pre></div>
</div>
</section>
<section id="display-the-equivalent-dipole-for-a-learned-topomap">
<h2>Display the equivalent dipole for a learned topomap<a class="headerlink" href="#display-the-equivalent-dipole-for-a-learned-topomap" title="Link to this heading">#</a></h2>
<p>Finally, let us fit a dipole to one of the atoms. To fit a dipole,
we need the following:</p>
<ul class="simple">
<li><p>BEM solution: Obtained by running the cortical reconstruction pipeline
of Freesurfer and describes the conductivity of different tissues in
the head.</p></li>
<li><p>Trans: An affine transformation matrix needed to bring the data
from sensor space to head space. This is usually done by coregistering
the fiducials with the MRI.</p></li>
<li><p>Noise covariance matrix: To whiten the data so that the assumption
of Gaussian noise model with identity covariance matrix is satisfied.</p></li>
</ul>
<p>We recommend users to consult the MNE documentation for further information.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subjects_dir</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/os.path.html#os.path.join" title="os.path.join" class="sphx-glr-backref-module-os-path sphx-glr-backref-type-py-function"><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/pathlib.html#pathlib.PosixPath" title="pathlib.PosixPath" class="sphx-glr-backref-module-pathlib sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data_path</span></a><span class="p">,</span> <span class="s1">&#39;subjects&#39;</span><span class="p">)</span>
<a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fname_bem</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/os.path.html#os.path.join" title="os.path.join" class="sphx-glr-backref-module-os-path sphx-glr-backref-type-py-function"><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subjects_dir</span></a><span class="p">,</span> <span class="s1">&#39;sample&#39;</span><span class="p">,</span> <span class="s1">&#39;bem&#39;</span><span class="p">,</span>
                         <span class="s1">&#39;sample-5120-bem-sol.fif&#39;</span><span class="p">)</span>
<a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fname_trans</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/os.path.html#os.path.join" title="os.path.join" class="sphx-glr-backref-module-os-path sphx-glr-backref-type-py-function"><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/pathlib.html#pathlib.PosixPath" title="pathlib.PosixPath" class="sphx-glr-backref-module-pathlib sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data_path</span></a><span class="p">,</span> <span class="s1">&#39;MEG&#39;</span><span class="p">,</span> <span class="s1">&#39;sample&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;sample_audvis_raw-trans.fif&#39;</span><span class="p">)</span>
<a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fname_cov</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/os.path.html#os.path.join" title="os.path.join" class="sphx-glr-backref-module-os-path sphx-glr-backref-type-py-function"><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/pathlib.html#pathlib.PosixPath" title="pathlib.PosixPath" class="sphx-glr-backref-module-pathlib sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data_path</span></a><span class="p">,</span> <span class="s1">&#39;MEG&#39;</span><span class="p">,</span> <span class="s1">&#39;sample&#39;</span><span class="p">,</span> <span class="s1">&#39;sample_audvis-cov.fif&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Let us construct an evoked object for MNE with the spatial pattern of the
atoms.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://mne.tools/stable/generated/mne.EvokedArray.html#mne.EvokedArray" title="mne.EvokedArray" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">evoked</span></a> <span class="o">=</span> <a href="https://mne.tools/stable/generated/mne.EvokedArray.html#mne.EvokedArray" title="mne.EvokedArray" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class"><span class="n">mne</span><span class="o">.</span><span class="n">EvokedArray</span></a><span class="p">(</span><a href="../../generated/alphacsc.GreedyCDL.html#alphacsc.GreedyCDL" title="alphacsc.GreedyCDL" class="sphx-glr-backref-module-alphacsc sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">cdl</span></a><span class="o">.</span><span class="n">u_hat_</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <a href="https://mne.tools/stable/generated/mne.Info.html#mne.Info" title="mne._fiff.meas_info.Info" class="sphx-glr-backref-module-mne-_fiff-meas_info sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">info</span></a><span class="p">)</span>
</pre></div>
</div>
<p>Fit a dipole to each of the atoms.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://mne.tools/stable/generated/mne.Dipole.html#mne.Dipole" title="mne.Dipole" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dip</span></a> <span class="o">=</span> <a href="https://mne.tools/stable/generated/mne.fit_dipole.html#mne.fit_dipole" title="mne.fit_dipole" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-function"><span class="n">mne</span><span class="o">.</span><span class="n">fit_dipole</span></a><span class="p">(</span><a href="https://mne.tools/stable/generated/mne.EvokedArray.html#mne.EvokedArray" title="mne.EvokedArray" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">evoked</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fname_cov</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fname_bem</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fname_trans</span></a><span class="p">,</span>
                     <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">n_jobs</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">n_jobs</span></a><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<p>Plot the dipole fit from the 3rd atom, linked to mu-wave and display the
goodness of fit.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">atom_dipole_idx</span></a> <span class="o">=</span> <span class="mi">4</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">mpl_toolkits.mplot3d</span><span class="w"> </span><span class="kn">import</span> <span class="n">Axes3D</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#tuple" title="builtins.tuple" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">figsize</span></a><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

<span class="c1"># Display the dipole fit</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
<a href="https://mne.tools/stable/generated/mne.Dipole.html#mne.Dipole.plot_locations" title="mne.Dipole.plot_locations" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-method"><span class="n">dip</span><span class="o">.</span><span class="n">plot_locations</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fname_trans</span></a><span class="p">,</span> <span class="s1">&#39;sample&#39;</span><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subjects_dir</span></a><span class="p">,</span> <span class="n">idx</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">atom_dipole_idx</span></a><span class="p">,</span>
                   <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Atom #</span><span class="si">{}</span><span class="s1"> (GOF </span><span class="si">{:.2f}</span><span class="s1">%)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">atom_dipole_idx</span></a><span class="p">,</span>
                                             <a href="https://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dip</span><span class="o">.</span><span class="n">gof</span></a><span class="p">[</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">atom_dipole_idx</span></a><span class="p">]))</span>

<span class="c1"># Plot the spatial map</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<a href="https://mne.tools/stable/generated/mne.viz.plot_topomap.html#mne.viz.plot_topomap" title="mne.viz.plot_topomap" class="sphx-glr-backref-module-mne-viz sphx-glr-backref-type-py-function"><span class="n">mne</span><span class="o">.</span><span class="n">viz</span><span class="o">.</span><span class="n">plot_topomap</span></a><span class="p">(</span><a href="../../generated/alphacsc.GreedyCDL.html#alphacsc.GreedyCDL" title="alphacsc.GreedyCDL" class="sphx-glr-backref-module-alphacsc sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">cdl</span></a><span class="o">.</span><span class="n">u_hat_</span><span class="p">[</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">atom_dipole_idx</span></a><span class="p">],</span> <a href="https://mne.tools/stable/generated/mne.Info.html#mne.Info" title="mne._fiff.meas_info.Info" class="sphx-glr-backref-module-mne-_fiff-meas_info sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">info</span></a><span class="p">,</span> <a href="https://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">axes</span></a><span class="o">=</span><span class="n">ax</span><span class="p">)</span>

<span class="c1"># Plot the temporal atom</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<a href="https://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">t</span></a> <span class="o">=</span> <a href="https://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.arange.html#numpy.arange" title="numpy.arange" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">arange</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">n_times_atom</span></a><span class="p">)</span> <span class="o">/</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">sfreq</span></a>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">t</span></a><span class="p">,</span> <a href="../../generated/alphacsc.GreedyCDL.html#alphacsc.GreedyCDL" title="alphacsc.GreedyCDL" class="sphx-glr-backref-module-alphacsc sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">cdl</span></a><span class="o">.</span><span class="n">v_hat_</span><span class="p">[</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">atom_dipole_idx</span></a><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">n_times_atom</span></a> <span class="o">/</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">sfreq</span></a><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Time (sec)&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Temporal pattern </span><span class="si">{}</span><span class="s2">&quot;</span>
       <span class="o">.</span><span class="n">format</span><span class="p">(</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">atom_dipole_idx</span></a><span class="p">))</span>

<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_sample_evoked_response_003.png" srcset="../../_images/sphx_glr_plot_sample_evoked_response_003.png" alt=", Atom #4 (GOF 47.27%), Temporal pattern 4" class = "sphx-glr-single-img"/><p class="sphx-glr-timing"><strong>Total running time of the script:</strong> (28 minutes 6.999 seconds)</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-examples-multicsc-plot-sample-evoked-response-py">
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/1c39b7d57f0cbdd5e17b12b075249eb0/plot_sample_evoked_response.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_sample_evoked_response.ipynb</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/b5f4fe8b8b1715cdf1a5937177423d6c/plot_sample_evoked_response.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_sample_evoked_response.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-zip docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/6f0030995ae9337b66018a7d476f2f28/plot_sample_evoked_response.zip"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">zipped:</span> <span class="pre">plot_sample_evoked_response.zip</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="sample_evoked_response_dicodile.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Extracting artifact and evoked response atoms from the MNE sample dataset</p>
      </div>
    </a>
    <a class="right-next"
       href="../noise_alpha/index.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Univariate CSC with an alpha-stable distribution</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#display-a-selection-of-atoms">Display a selection of atoms</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#display-the-evoked-reconstructed-envelope">Display the evoked reconstructed envelope</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#display-the-equivalent-dipole-for-a-learned-topomap">Display the equivalent dipole for a learned topomap</a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/auto_examples/multicsc/plot_sample_evoked_response.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
    <script src="/versionwarning.js"></script>
    
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2017-2018, Mainak Jas.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.4.7.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>